<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AR Multiple Marker Popup</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
  <style>
    body { margin:0; overflow:hidden; font-family:sans-serif; }

    .popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 800px;
      background: #000;
      border-radius: 8px;
      display: none;
      z-index: 100;
      padding: 0;
    }

    .closeBtn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: red;
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 6px 12px;
      cursor: pointer;
      z-index: 101;
    }

    iframe {
      width: 100%;
      height: 400px;
      border: none;
      border-radius: 0 0 8px 8px;
    }

    img {
      width: 100%;
      height: auto;
      border-radius: 0 0 8px 8px;
      display: block;
    }
  </style>
</head>
<body>

  <!-- HIRO 影片視窗 -->
  <div id="hiroVideoPopup" class="popup">
    <button class="closeBtn" onclick="closeVideo('hiroVideoPopup', 'hiroPlayer')">關閉</button>
    <iframe id="hiroPlayer" src="" allow="autoplay; encrypted-media" allowfullscreen></iframe>
  </div>

  <!-- 自訂 marker 影片視窗 -->
  <div id="customVideoPopup" class="popup">
    <button class="closeBtn" onclick="closeVideo('customVideoPopup', 'customPlayer')">關閉</button>
    <iframe id="customPlayer" src="" allow="autoplay; encrypted-media" allowfullscreen></iframe>
  </div>

  <!-- Kanji 圖片視窗 -->
  <div id="kanjiPopup" class="popup">
    <button class="closeBtn" onclick="closeImage()">關閉</button>
    <img src="assets/test.jpg" alt="Kanji Image">
  </div>

  <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false;'>

    <!-- HIRO marker -->
    <a-marker preset="hiro" id="hiroMarker"></a-marker>

    <!-- Kanji marker -->
    <a-marker preset="kanji" id="kanjiMarker"></a-marker>

    <!-- 自訂 marker -->
    <a-marker type="pattern" url="assets/mymarker.patt" id="customMarker"></a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    let popupActive = false;

    const hiroMarker = document.getElementById('hiroMarker');
    const kanjiMarker = document.getElementById('kanjiMarker');
    const customMarker = document.getElementById('customMarker');

    const hiroVideoPopup = document.getElementById('hiroVideoPopup');
    const hiroPlayer = document.getElementById('hiroPlayer');

    const customVideoPopup = document.getElementById('customVideoPopup');
    const customPlayer = document.getElementById('customPlayer');

    const kanjiPopup = document.getElementById('kanjiPopup');

    // HIRO marker → 播放影片
    hiroMarker.addEventListener('markerFound', () => {
      if (!popupActive) {
        hiroPlayer.src = "https://www.youtube.com/embed/cci1yhDeOjs?autoplay=1";
        hiroVideoPopup.style.display = 'block';
        popupActive = true;
      }
    });

    // Kanji marker → 顯示圖片
    kanjiMarker.addEventListener('markerFound', () => {
      if (!popupActive) {
        kanjiPopup.style.display = 'block';
        popupActive = true;
      }
    });

    // 自訂 marker → 播放影片
    customMarker.addEventListener('markerFound', () => {
      if (!popupActive) {
        customPlayer.src = "https://www.youtube.com/embed/r60oS7odiJY?autoplay=1";
        customVideoPopup.style.display = 'block';
        popupActive = true;
      }
    });

    // 關閉影片
    function closeVideo(popupId, playerId) {
      document.getElementById(popupId).style.display = 'none';
      document.getElementById(playerId).src = "";
      popupActive = false;
    }

    // 關閉圖片
    function closeImage() {
      kanjiPopup.style.display = 'none';
      popupActive = false;
    }
  </script>

</body>
</html>
